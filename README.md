# 교인 소그룹 자동 편성 시스템 (Small Group Sorter)

교회 교인 명단을 **나이**와 **출석 현황**을 기반으로 자동으로 소그룹을 편성하는 시스템입니다.

## 주요 기능

- 📊 **엑셀/CSV 파일 지원**: `.xlsx`, `.csv` 형식의 교인 명단 로드
- 👥 **또래 편성**: 비슷한 연령대끼리 그룹 구성 (±N살 허용 오차 설정 가능)
- ⚖️ **균형 잡힌 그룹**: 출석률 높은 멤버(리더 감)와 낮은 멤버(케어 대상)를 균등 분배
- 📈 **통계 제공**: 그룹별 인원, 평균 나이, 출석 분포 통계 자동 생성

## 설치

```bash
pip install -r requirements.txt
```

## 사용법

### 기본 사용
```bash
python main.py raw_data.xlsx
```

### 옵션 지정
```bash
python main.py raw_data.xlsx -o result.xlsx --group-size 8 --age-tolerance 7
```

### 명령줄 옵션
| 옵션 | 설명 | 기본값 |
|------|------|--------|
| `-o, --output` | 출력 파일 경로 | sorted_result.xlsx |
| `-g, --group-size` | 그룹당 목표 인원 | 10 |
| `-a, --age-tolerance` | 허용 나이 차이 ±N살 | 5 |

## 입력 파일 형식

| 이름 | 나이 | 출석현황 | 비고 |
|------|------|----------|------|
| 김철수 | 34 | A | |
| 이영희 | 32 | C | |
| 박민수 | 35 | B | |

### 출석현황 등급
- **A**: 매주 출석 (리더 그룹)
- **B**: 월 2-3회
- **C**: 가끔
- **D**: 장기결석 (케어 대상)

## 출력 결과

### 소그룹 편성 결과 시트
| 소그룹명 | 이름 | 나이 | 출석현황 | 분류결과 |
|----------|------|------|----------|----------|
| 1조 | 김철수 | 34 | A | 리더 그룹 |
| 1조 | 이영희 | 32 | C | 일반 |

### 그룹별 통계 시트
| 소그룹명 | 인원수 | 평균나이 | 최소나이 | 최대나이 | 리더그룹수 | 케어대상수 |
|----------|--------|----------|----------|----------|------------|------------|
| 1조 | 10 | 33.5 | 28 | 38 | 2 | 1 |

## 프로젝트 구조

```
cell-group/
├── main.py                 # 메인 실행 파일
├── requirements.txt        # 의존성 패키지
├── README.md              # 사용 설명서
├── sample_data.xlsx       # 샘플 데이터
├── create_sample_data.py  # 샘플 데이터 생성 스크립트
├── src/
│   ├── __init__.py
│   ├── config.py          # 설정 관리
│   ├── data_loader.py     # 데이터 입출력
│   ├── preprocessor.py    # 데이터 전처리
│   └── sorter.py          # 편성 알고리즘
└── tests/
    ├── __init__.py
    └── test_sorter.py     # 단위 테스트
```

## 테스트 실행

```bash
# 샘플 데이터 생성
python create_sample_data.py

# 테스트 실행
pytest tests/ -v

# 전체 프로세스 테스트
python main.py sample_data.xlsx
```

## 라이선스

MIT License
