교회 사역에 기술을 접목하여 효율을 높이려는 목사님의 시도가 멋집니다. 말씀하신 내용을 바탕으로 **'교인 소그룹 자동 편성 시스템'** 개발을 위한 **PRD(제품 요구사항 정의서)**를 작성해 드립니다.

# [PRD] 교인 소그룹 자동 편성 시스템 (Small Group Sorter)

## 1. 프로젝트 개요 (Overview)

* **목표:** 엑셀로 관리되는 전체 교인 명단을 '나이'와 '출석 현황'이라는 두 가지 핵심 변수를 기준으로, 최적의 소그룹으로 자동 분류하여 사역자의 행정 소요를 줄이고 균형 잡힌 공동체를 형성한다.
* **개발 도구:** Google Antigravity (Python 기반 코드 생성 및 실행)
* **최종 산출물:** 소그룹 편성이 완료된 결과 엑셀 파일 (.xlsx)

## 2. 유저 시나리오 (User Scenario)

1. 사용자(목사/담당자)는 교인 명단이 담긴 엑셀 파일을 준비한다. (필수 컬럼: 이름, 나이, 출석률/등급)
2. 시스템에 엑셀 파일과 그룹당 목표 인원(예: 10명)을 입력한다.
3. 시스템은 알고리즘에 따라 교인을 자동으로 배정한다.
4. 시스템은 배정 결과가 포함된 새로운 엑셀 파일을 사용자에게 제공한다.

## 3. 핵심 기능 요구사항 (Functional Requirements)

### 3.1. 데이터 입력 (Input)

* **지원 형식:** `.xlsx` 또는 `.csv`
* **필수 데이터 필드:**
1. `이름` (String): 교인 식별자
2. `나이` (Integer): 생년월일이 아닌 '만 나이' 또는 '한국 나이' (정수형)
3. `출석현황` (String or Integer):
* 옵션 A (점수제): 주일 성수 횟수 (예: 52주 중 40회)
* 옵션 B (등급제): A급(매주), B급(월 2-3회), C급(가끔), D급(장기결석) 등

### 3.2. 분류 알고리즘 로직 (Core Logic)

* **우선순위 1: 나이 (또래 편성 vs 세대 통합)**
* *기본 설정:* **'또래 편성'**을 기준으로 한다. (비슷한 연령대끼리 묶음)
* *허용 오차:* 그룹 내 최대 나이 차이는 ±N살(예: 5살) 이내로 제한한다.

* **우선순위 2: 출석 현황 (균등 분배)**
* 각 소그룹이 건강하게 유지되도록 **'리더 감(출석률 높음)'**과 **'케어 대상자(출석률 낮음)'**를 골고루 섞는다.
* *로직:* 그룹별 '평균 출석 점수'가 비슷해지도록 분산 배치한다. (S자형 배치 알고리즘 권장)

### 3.3. 데이터 출력 (Output)

* 결과 파일에 `소그룹_번호` 또는 `조_이름` 컬럼이 추가되어야 한다.
* 각 그룹별 인원 통계(평균 나이, 출석 분포)가 별도 시트에 요약되면 좋다.

## 4. 기술적 요구사항 (Technical Specifications)

* **언어:** Python 3.x
* **라이브러리:**
* `pandas`: 엑셀 데이터 입출력 및 데이터프레임 조작
* `openpyxl`: 엑셀 서식 유지 (필요 시)
* `numpy`: 수치 계산 및 통계 처리

* **에러 처리:**
* 나이 데이터에 숫자가 아닌 값(예: "불명")이 있을 경우 예외 처리하거나 '평균 나이'로 대체.
* 인원이 딱 떨어지지 않을 경우, 마지막 조에 인원을 더하거나 덜어서 조정.

* **성능:** 최대 10,000명 이상의 교인 데이터도 원활히 처리 가능해야 함.

## 5. 데이터 구조 예시 (Data Structure)

**[Input: raw_data.xlsx]**
| 이름 | 나이 | 출석현황(등급) | 비고 |
| :--- | :--- | :--- | :--- |
| 김철수 | 34 | A | |
| 이영희 | 32 | C | |
| 박민수 | 35 | B | |

**[Output: sorted_result.xlsx]**
| 소그룹명 | 이름 | 나이 | 출석현황 | 분류결과 |
| :--- | :--- | :--- | :--- | :--- |
| 1조 | 김철수 | 34 | A | 리더 그룹 |
| 1조 | 이영희 | 32 | C | 케어 대상 |
| 1조 | ... | ... | ... | ... |

---